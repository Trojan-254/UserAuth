<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Zetu Cart - Manage Products</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50">
  <div class="flex min-h-screen">
    <!-- Sidebar -->
    <aside class="w-64 bg-gradient-to-b from-orange-600 to-orange-700 text-white p-6 shadow-xl flex flex-col">
      <div class="flex items-center mb-10">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
        </svg>
        <h2 class="text-2xl font-bold">Seller Portal</h2>
      </div>

      <nav class="space-y-2 flex-1">
        <a href="#" class="flex items-center p-3 rounded-lg hover:bg-orange-500 transition-colors duration-200">
          <i class="fas fa-chart-line w-5 mr-3"></i>
          Dashboard
        </a>
        <a href="#" class="flex items-center p-3 rounded-lg bg-orange-500 hover:bg-orange-400 transition-colors duration-200">
          <i class="fas fa-box w-5 mr-3"></i>
          Products
        </a>
        <a href="#" class="flex items-center p-3 rounded-lg hover:bg-orange-500 transition-colors duration-200">
          <i class="fas fa-shopping-bag w-5 mr-3"></i>
          Orders
        </a>
        <a href="#" class="flex items-center p-3 rounded-lg hover:bg-orange-500 transition-colors duration-200">
          <i class="fas fa-warehouse w-5 mr-3"></i>
          Inventory
        </a>
        <a href="#" class="flex items-center p-3 rounded-lg hover:bg-orange-500 transition-colors duration-200">
          <i class="fas fa-users w-5 mr-3"></i>
          Customers
        </a>
      </nav>

      <div class="mt-auto">
        <div class="p-4 bg-orange-500 rounded-lg mb-4">
          <p class="text-sm mb-2">Verification Status</p>
          <div class="flex items-center">
            <span class="bg-green-500 px-2 py-1 rounded text-xs">Verified</span>
          </div>
        </div>
        <button class="w-full flex items-center p-3 rounded-lg hover:bg-orange-500 transition-colors duration-200">
          <i class="fas fa-sign-out-alt w-5 mr-3"></i>
          Logout
        </button>
      </div>
    </aside>

    <main class="flex-1 p-8">
      <!-- Top Navigation -->
      <nav class="bg-white p-4 rounded-xl shadow-sm mb-8 flex justify-between items-center">
        <div class="flex items-center">
          <div class="relative">
            <input type="text" placeholder="Search products..." class="pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:outline-none focus:border-orange-500">
            <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
          </div>
        </div>
        <div class="flex items-center space-x-4">
          <a href="#" class="relative">
            <i class="fas fa-bell text-gray-600 text-xl"></i>
            <span class="absolute -top-2 -right-2 bg-orange-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">3</span>
          </a>
          <div class="flex items-center space-x-2">
            <img src="/api/placeholder/32/32" alt="Profile" class="w-8 h-8 rounded-full">
            <span class="text-gray-700">Mama Ntilie Shop</span>
          </div>
        </div>
      </nav>

      <!-- Product Management Header -->
      <div class="mb-8 flex justify-between items-center">
        <div>
          <h1 class="text-2xl font-bold text-gray-800">Bidhaa Zangu (My Products)</h1>
          <p class="text-gray-600">Manage your product catalog</p>
        </div>
        <button onclick="showAddProductModal()" class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-lg flex items-center space-x-2">
          <i class="fas fa-plus"></i>
          <span>Add New Product</span>
        </button>
      </div>

      <!-- Product Filters -->
      <div class="bg-white p-6 rounded-xl shadow-sm mb-8">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
            <select class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
              <option value="">All Categories</option>
              <option value="handcrafts">Handcrafts</option>
              <option value="agriculture">Agricultural Products</option>
              <option value="textiles">Textiles & Fabrics</option>
              <option value="food">Food & Beverages</option>
              <option value="beauty">Beauty & Wellness</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Stock Status</label>
            <select class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
              <option value="">All Status</option>
              <option value="in_stock">In Stock</option>
              <option value="low_stock">Low Stock</option>
              <option value="out_of_stock">Out of Stock</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Price Range</label>
            <div class="flex space-x-2">
              <input type="number" placeholder="Min" class="w-1/2 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
              <input type="number" placeholder="Max" class="w-1/2 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Sort By</label>
            <select class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
              <option value="newest">Newest First</option>
              <option value="oldest">Oldest First</option>
              <option value="price_high">Price: High to Low</option>
              <option value="price_low">Price: Low to High</option>
              <option value="bestselling">Best Selling</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Products Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8">
        <!-- Sample Product 1 -->
        <div class="bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300">
          <div class="relative">
            <img src="/api/placeholder/400/300" alt="Handwoven Basket" class="w-full h-48 object-cover">
            <div class="absolute top-2 right-2 space-x-2">
              <button onclick="editProduct('1')" class="bg-white p-2 rounded-full shadow hover:bg-gray-100">
                <i class="fas fa-edit text-gray-600"></i>
              </button>
              <button onclick="confirmDelete('1')" class="bg-white p-2 rounded-full shadow hover:bg-gray-100">
                <i class="fas fa-trash text-red-500"></i>
              </button>
            </div>
            <span class="absolute top-2 left-2 bg-red-500 text-white px-2 py-1 rounded-lg text-xs">Low Stock</span>
          </div>
          
          <div class="p-4">
            <h3 class="font-semibold text-lg mb-2">Handwoven Kiondo Basket</h3>
            <div class="flex justify-between items-center mb-2">
              <span class="text-orange-500 font-bold">KES 1,500</span>
              <span class="text-gray-500 text-sm">5 in stock</span>
            </div>
            
            <div class="space-y-2">
              <div class="flex items-center text-sm">
                <i class="fas fa-chart-line w-5 text-gray-500"></i>
                <span class="ml-2">150 sold</span>
              </div>
              <div class="flex items-center text-sm">
                <i class="fas fa-star w-5 text-yellow-400"></i>
                <span class="ml-2">4.8 (124 reviews)</span>
              </div>
            </div>

            <div class="mt-4 grid grid-cols-2 gap-2">
              <button onclick="quickEdit('1')" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm">
                Quick Edit
              </button>
              <button onclick="viewDetails('1')" class="bg-orange-100 hover:bg-orange-200 text-orange-700 px-4 py-2 rounded-lg text-sm">
                View Details
              </button>
            </div>
          </div>
        </div>

        <!-- Sample Product 2 -->
        <div class="bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300">
          <div class="relative">
            <img src="/api/placeholder/400/300" alt="Organic Coffee" class="w-full h-48 object-cover">
            <div class="absolute top-2 right-2 space-x-2">
              <button onclick="editProduct('2')" class="bg-white p-2 rounded-full shadow hover:bg-gray-100">
                <i class="fas fa-edit text-gray-600"></i>
              </button>
              <button onclick="confirmDelete('2')" class="bg-white p-2 rounded-full shadow hover:bg-gray-100">
                <i class="fas fa-trash text-red-500"></i>
              </button>
            </div>
          </div>
          
          <div class="p-4">
            <h3 class="font-semibold text-lg mb-2">Organic Kenyan Coffee</h3>
            <div class="flex justify-between items-center mb-2">
              <span class="text-orange-500 font-bold">KES 850</span>
              <span class="text-gray-500 text-sm">45 in stock</span>
            </div>
            
            <div class="space-y-2">
              <div class="flex items-center text-sm">
                <i class="fas fa-chart-line w-5 text-gray-500"></i>
                <span class="ml-2">280 sold</span>
              </div>
              <div class="flex items-center text-sm">
                <i class="fas fa-star w-5 text-yellow-400"></i>
                <span class="ml-2">4.9 (230 reviews)</span>
              </div>
            </div>

            <div class="mt-4 grid grid-cols-2 gap-2">
              <button onclick="quickEdit('2')" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm">
                Quick Edit
              </button>
              <button onclick="viewDetails('2')" class="bg-orange-100 hover:bg-orange-200 text-orange-700 px-4 py-2 rounded-lg text-sm">
                View Details
              </button>
            </div>
          </div>
        </div>

        <!-- Sample Product 3 -->
        <div class="bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300">
          <div class="relative">
            <img src="/api/placeholder/400/300" alt="Maasai Shuka" class="w-full h-48 object-cover">
            <div class="absolute top-2 right-2 space-x-2">
              <button onclick="editProduct('3')" class="bg-white p-2 rounded-full shadow hover:bg-gray-100">
                <i class="fas fa-edit text-gray-600"></i>
              </button>
              <button onclick="confirmDelete('3')" class="bg-white p-2 rounded-full shadow hover:bg-gray-100">
                <i class="fas fa-trash text-red-500"></i>
              </button>
            </div>
          </div>
          
          <div class="p-4">
            <h3 class="font-semibold text-lg mb-2">Traditional Maasai Shuka</h3>
            <div class="flex justify-between items-center mb-2">
              <span class="text-orange-500 font-bold">KES 2,500</span>
              <span class="text-gray-500 text-sm">28 in stock</span>
            </div>
            
            <div class="space-y-2">
              <div class="flex items-center text-sm">
                <i class="fas fa-chart-line w-5 text-gray-500"></i>
                <span class="ml-2">175 sold</span>
              </div>
              <div class="flex items-center text-sm">
                <i class="fas fa-star w-5 text-yellow-400"></i>
                <span class="ml-2">4.7 (89 reviews)</span>
              </div>
            </div>

            <div class="mt-4 grid grid-cols-2 gap-2">
              <button onclick="quickEdit('3')" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm">
                Quick Edit
              </button>
              <button onclick="viewDetails('3')" class="bg-orange-100 hover:bg-orange-200 text-orange-700 px-4 py-2 rounded-lg text-sm">
                View Details
              </button>
            </div>
          </div>
        </div>

        <!-- Sample Product 4 -->
        <div class="bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300">
          <div class="relative">
            <img src="/api/placeholder/400/300" alt="Beaded Necklace" class="w-full h-48 object-cover">
            <div class="absolute top-2 right-2 space-x-2">
              <button onclick="editProduct('4')" class="bg-white p-2 rounded-full shadow hover:bg-gray-100">
                <i class="fas fa-edit text-gray-600"></i>
              </button>
              <button onclick="confirmDelete('4')" class="bg-white p-2 rounded-full shadow hover:bg-gray-100">
                <i class="fas fa-trash text-red-500"></i>
              </button>
            </div>
          </div>
          
          <div class="p-4">
            <h3 class="font-semibold text-lg mb-2">Maasai Beaded Necklace</h3>
            <div class="flex justify-between items-center mb-2">
              <span class="text-orange-500 font-bold">KES 1,200</span>
              <span class="text-gray-500 text-sm">15 in stock</span>
            </div>
            
            <div class="space-y-2">
              <div class="flex items-center text-sm">
                <i class="fas fa-chart-line w-5 text-gray-500"></i>
                <span class="ml-2">95 sold</span>
              </div>
              <div class="flex items-center text-sm">
                <i class="fas fa-star w-5 text-yellow-400"></i>
                <span class="ml-2">4.6 (67 reviews)</span>
              </div>
            </div>

            <div class="mt-4 grid grid-cols-2 gap-2">
              <button onclick="quickEdit('4')" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm">
                Quick Edit
              </button>
              <button onclick="viewDetails('4')" class="bg-orange-100 hover:bg-orange-200 text-orange-700 px-4 py-2 rounded-lg text-sm">
                View Details
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Pagination -->
      <div class="flex justify-center items-center space-x-2 mb-8">
        <button class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50" disabled>
          <i class="fas fa-chevron-left"></i>
        </button>
        <button class="px-4 py-2 border border-orange-500 bg-orange-500 text-white rounded-lg">1</button>
        <button class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">2</button>
        <button class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">3</button>
        <span class="px-4 py-2">...</span>
        <button class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">8</button>
        <button class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>

      <!-- Add/Edit Product Modal -->
      <div id="productModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto">
          <div class="p-6">
            <div class="flex justify-between items-center mb-6">
              <h2 class="text-2xl font-bold" id="modalTitle">Add New Product</h2>
              <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700">
                <i class="fas fa-times"></i>
              </button>
            </div>
            
            <!-- Product Creation form -->
<form id="productForm" class="space-y-6">
  <div class="grid grid-cols-2 gap-6">
      <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Product Name*</label>
          <input type="text" name="name" placeholder="Enter product name" 
                 class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500" 
                 required>
      </div>
      <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">SKU*</label>
          <input type="text" name="sku" placeholder="Enter product SKU" 
                 class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500" 
                 required>
      </div>
  </div>

  <div class="grid grid-cols-2 gap-6">
      <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Category*</label>
          <select name="category" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500" required>
              <option value="">Select Category</option>
              <option value="handcrafts">Handcrafts</option>
              <option value="agriculture">Agricultural Products</option>
              <option value="textiles">Textiles & Fabrics</option>
              <option value="food">Food & Beverages</option>
              <option value="beauty">Beauty & Wellness</option>
          </select>
      </div>
      <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Price (KES)*</label>
          <input type="number" name="price" placeholder="0.00" min="0" step="0.01"
                 class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500" 
                 required>
      </div>
  </div>

  <div class="grid grid-cols-3 gap-6">
      <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Sale Price (KES)</label>
          <input type="number" name="salePrice" placeholder="0.00" min="0" step="0.01"
                 class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
      </div>
      <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Stock Quantity*</label>
          <input type="number" name="stock" placeholder="0" min="0"
                 class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500" 
                 required>
      </div>
      <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Weight (kg)</label>
          <input type="number" name="weight" placeholder="0.0" min="0" step="0.1"
                 class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500">
      </div>
  </div>

  <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">Description*</label>
      <textarea name="description" rows="4" placeholder="Describe your product..." 
                class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500" 
                required></textarea>
  </div>

  <!-- Product Specification Field -->
  <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">Product Specifications</label>
      <textarea name="specifications" rows="4" placeholder="Enter detailed product specifications..."
                class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"></textarea>
  </div>

  <div class="mb-6">
    <label class="block text-sm font-semibold text-gray-700 mb-2">Main Image*</label>
    <div class="flex items-center space-x-4">
        <div class="relative">
            <img id="mainImagePreview" 
                 src="/api/placeholder/150/150" 
                 alt="Main image preview" 
                 class="image-preview rounded-lg border">
            <button type="button" 
                    id="removeMainImage" 
                    class="absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hidden hover:bg-red-600 transition-colors">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="flex-1">
            <label class="block w-full cursor-pointer">
                <span class="sr-only">Choose main image</span>
                <input type="file" 
                       multiple
                       id="imageUpload" 
                       name="mainImage" 
                       accept="image/*"
                       required
                       class="block w-full text-sm text-gray-500
                              file:mr-4 file:py-2 file:px-4
                              file:rounded-full file:border-0
                              file:text-sm file:font-semibold
                              file:bg-red-50 file:text-red-700
                              hover:file:bg-red-100">
            </label>
            <p class="text-xs text-gray-500 mt-1">Click to upload an image or drag and drop</p>
            <p class="text-xs text-gray-500 mt-1">PNG, JPG up to 5MB</p>
            <span class="error-message" id="mainImageError"></span>
        </div>
    </div>
</div>


  <!-- Additional images upload -->
  <div class="mb-6">
    <label class="block text-sm font-semibold text-gray-700 mb-2">Additional Images</label>
    <div id="additionalImagesPreview" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"></div>
    <label class="block w-full cursor-pointer">
        <span class="sr-only">Choose additional images</span>
        <input type="file" 
               id="additionalImages" 
               name="additionalImages" 
               accept="image/*"
               multiple
               class="block w-full text-sm text-gray-500
                      file:mr-4 file:py-2 file:px-4
                      file:rounded-full file:border-0
                      file:text-sm file:font-semibold
                      file:bg-red-50 file:text-red-700
                      hover:file:bg-orange-100">
    </label>
    <p class="text-xs text-gray-500 mt-1">Up to 4 additional images</p>
    <span class="error-message" id="additionalImagesError"></span>
</div>
</form>

              <div class="flex justify-end space-x-4">
                <button type="button" onclick="closeModal()" class="px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                  Cancel
                </button>
                <button type="submit" class="px-6 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600">
                  Save Product
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Delete Confirmation Modal -->
      <div id="deleteModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 w-full max-w-md">
          <h3 class="text-xl font-bold mb-4">Delete Product</h3>
          <p class="text-gray-600 mb-6">Are you sure you want to delete this product? This action cannot be undone.</p>
          <div class="flex justify-end space-x-4">
            <button onclick="closeDeleteModal()" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
              Cancel
            </button>
            <button onclick="deleteProduct()" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">
              Delete
            </button>
          </div>
        </div>
      </div>
    </main>
  </div>


  <footer class="mt-12 text-center text-gray-500 text-sm">
        <p>&copy; 2025 Zetu Cart • Seller Portal</p>
        <div class="mt-2">
          <a href="/seller/help" class="hover:text-orange-500">Help Center</a> • 
          <a href="/seller/terms" class="hover:text-orange-500">Terms for Sellers</a> • 
          <a href="/seller/support" class="hover:text-orange-500">Seller Support</a>
        </div>
      </footer>

  <script>

const productForm = {
            init() {
                this.form = document.getElementById('productForm');
                this.mainImageInput = document.getElementById('imageUpload');
                this.additionalImagesInput = document.getElementById('additionalImages');
                this.mainImagePreview = document.getElementById('mainImagePreview');
                this.removeMainImageBtn = document.getElementById('removeMainImage');
                this.additionalImagesPreview = document.getElementById('additionalImagesPreview');
                this.submitBtn = this.form.querySelector('button[type="submit"]');
                this.submitText = document.getElementById('submitText');
                this.submitSpinner = document.getElementById('submitSpinner');
                
                this.setupEventListeners();
            },
    
            setupEventListeners() {
                this.form.addEventListener('submit', this.handleSubmit.bind(this));
                this.mainImageInput.addEventListener('change', this.handleMainImageChange.bind(this));
                this.additionalImagesInput.addEventListener('change', this.handleAdditionalImagesChange.bind(this));
                this.removeMainImageBtn.addEventListener('click', this.handleRemoveMainImage.bind(this));
            },
    
            async handleSubmit(event) {
                event.preventDefault();
                
                if (!this.validateForm()) {
                    return;
                }
    
                this.setLoadingState(true);
    
                try {
                    const formData = new FormData(this.form);
                    console.log('Form data:', formData);
                    
                    const response = await fetch('/products/create-new', {
                        method: 'POST',
                        body: formData
                    });
    
                    const result = await response.json();
                    console.log('Response:', result);
    
                    if (response.ok) {
                        this.showToast('Product created successfully!', 'success');
                        // Redirect to dashboard after a short delay
                        setTimeout(() => {
                            window.location.href = '/seller/dashboard';
                        }, 1500);
                    } else {
                        throw new Error(result.message || 'Failed to create product');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    this.showToast(error.message, 'error');
                    this.setLoadingState(false);
                }
            },
    
            validateForm() {
                let isValid = true;
    
                // Clear previous error messages
                document.querySelectorAll('.error-message').forEach((el) => {
                    el.style.display = 'none';
                });
    
                // Validate Product Name
                const name = this.form.name.value.trim();
                if (!name) {
                    document.getElementById('nameError').textContent = 'Product name is required.';
                    document.getElementById('nameError').style.display = 'block';
                    isValid = false;
                }
    
                // Validate SKU
                const sku = this.form.sku.value.trim();
                if (!sku) {
                    document.getElementById('skuError').textContent = 'SKU is required.';
                    document.getElementById('skuError').style.display = 'block';
                    isValid = false;
                }
    
                // Validate Category
                const category = this.form.category.value;
                if (!category) {
                    document.getElementById('categoryError').textContent = 'Category is required.';
                    document.getElementById('categoryError').style.display = 'block';
                    isValid = false;
                }
    
                // Validate Price
                const price = this.form.price.value.trim();
                if (!price || price <= 0) {
                    document.getElementById('priceError').textContent = 'Price must be greater than 0.';
                    document.getElementById('priceError').style.display = 'block';
                    isValid = false;
                }
    
                // Validate Sale Price (if provided)
                const salePrice = this.form.salePrice.value.trim();
                if (salePrice && parseFloat(salePrice) >= parseFloat(price)) {
                    document.getElementById('salePriceError').textContent = 'Sale price must be less than regular price.';
                    document.getElementById('salePriceError').style.display = 'block';
                    isValid = false;
                }
    
                // Validate Stock
                const stock = this.form.stock.value.trim();
                if (!stock || stock < 0) {
                    document.getElementById('stockError').textContent = 'Stock must be 0 or more.';
                    document.getElementById('stockError').style.display = 'block';
                    isValid = false;
                }
    
                // Validate Description
                const description = this.form.description.value.trim();
                if (!description) {
                    document.getElementById('descriptionError').textContent = 'Description is required.';
                    document.getElementById('descriptionError').style.display = 'block';
                    isValid = false;
                }
    
                // Validate Main Image
                if (!this.mainImageInput.files.length) {
                    document.getElementById('mainImageError').textContent = 'Main image is required.';
                    document.getElementById('mainImageError').style.display = 'block';
                    isValid = false;
                }
    
                return isValid;
            },
    
            handleMainImageChange(event) {
                const file = event.target.files[0];
                if (file) {
                    if (file.size > 5 * 1024 * 1024) {
                        this.showToast('Image size should not exceed 5MB', 'error');
                        event.target.value = '';
                        return;
                    }
    
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        this.mainImagePreview.src = e.target.result;
                        this.removeMainImageBtn.classList.remove('hidden');
                    };
                    reader.readAsDataURL(file);
                }
            },
    
            handleAdditionalImagesChange(event) {
                this.additionalImagesPreview.innerHTML = '';
                Array.from(event.target.files).forEach((file, index) => {
                    if (index < 4) {
                        if (file.size > 5 * 1024 * 1024) {
                            this.showToast(`Image ${file.name} exceeds 5MB limit`, 'error');
                            return;
                        }
    
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const img = document.createElement('img');
                            img.src = e.target.result;
                            img.classList.add('image-preview', 'rounded-lg', 'border');
                            this.additionalImagesPreview.appendChild(img);
                        };
                        reader.readAsDataURL(file);
                    }
                });
            },
    
            handleRemoveMainImage() {
                this.mainImageInput.value = '';
                this.mainImagePreview.src = '/api/placeholder/150/150';
                this.removeMainImageBtn.classList.add('hidden');
            },
    
            setLoadingState(isLoading) {
                this.submitText.style.display = isLoading ? 'none' : 'inline';
                this.submitSpinner.style.display = isLoading ? 'block' : 'none';
                this.submitBtn.disabled = isLoading;
            },
    
            showToast(message, type = 'info') {
                const toast = document.getElementById('toast');
                toast.querySelector('span').textContent = message;
                toast.classList.remove('bg-gray-900', 'bg-red-600', 'bg-green-600');
                toast.classList.add(type === 'success' ? 'bg-green-600' : 'bg-red-600');
                toast.style.opacity = '1';
                toast.style.transform = 'translateY(0)';
    
                setTimeout(() => {
                    toast.style.opacity = '0';
                    toast.style.transform = 'translateY(100%)';
                }, 3000);
            },
    
            resetForm() {
                this.form.reset();
                this.handleRemoveMainImage();
                this.additionalImagesPreview.innerHTML = '';
                document.querySelectorAll('.error-message').forEach(el => {
                    el.style.display = 'none';
                });
            }
        };
    
        document.addEventListener('DOMContentLoaded', () => {
            productForm.init();
        });
    // Modal Functions
    function showAddProductModal() {
      document.getElementById('productModal').classList.remove('hidden');
    }

    function closeModal() {
      document.getElementById('productModal').classList.add('hidden');
    }

    function confirmDelete(productId) {
      document.getElementById('deleteModal').classList.remove('hidden');
      document.getElementById('deleteModal').setAttribute('data-product-id', productId);
    }

    function closeDeleteModal() {
      document.getElementById('deleteModal').classList.add('hidden');
    }

    function deleteProduct() {
      const productId = document.getElementById('deleteModal').getAttribute('data-product-id');
      // Here you would typically make an API call to delete the product
      console.log('Deleting product:', productId);
      closeDeleteModal();
      // Refresh the page or update the UI
    }

    function quickEdit(productId) {
      // Implement quick edit functionality
      console.log('Quick editing product:', productId);
    }

    function viewDetails(productId) {
      // Implement view details functionality
      console.log('Viewing details for product:', productId);
    }

    // Form submission handler
    document.getElementById('productForm').addEventListener('submit', function(e) {
      e.preventDefault();
      // Here you would typically make an API call to save the product
      const formData = new FormData(this);
      console.log('Form submitted with data:', Object.fromEntries(formData));
      closeModal();
      // Refresh the page or update the UI
    });

    // File upload preview (if needed)
    document.getElementById('imageUpload').addEventListener('change', function(e) {
      // Implement image preview functionality
      console.log('Files selected:', e.target.files);
    });
  </script>
</body>
</html>